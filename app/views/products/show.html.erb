<% provide(:title, @product.name) %>
<div class= "container-fluid product-container">
    <div class="product-show-container" data-behavior="commentable_<%= @product.id %>">

      <% cache [@product, @product.user.profile] do %>

        <div class="row product-show-name">
          <div class="col-md-7">
            <%= image_tag @product.product_image_url(:base_thumb) %>
            <h3><%= @product.name.upcase %></h3>
          </div>
          <div class="col-md-5" style="vertical-algin:middle;">
            <span class="hidden" data-behavior="edit-delete-product-buttons" data-product-user-id= "<%=@product.user_id %>">
              <%= link_to "Edit Product", edit_product_path(@product), class: "btn btn-primary" %>
              <button type="button" class="btn btn-danger delete-button" data-toggle="modal" data-target="#deleteproduct_<%= @product.id %>">Delete Product</button>
            </span>
          </div>
        </div>
        <div class="well product-well">
          <div class = "row">
            <div class="col-md-4 website-column">
              <div class="product-list">
                <div class="list-name">Website:</div>
                <div class="description"><%= link_to @product.website, target: "_blank" do %>
                   <%= @product.website %>
                <% end %></div>
              </div>
            </div>
            <div class="col-md-8 vertical-column">
              <div class="product-list">
                <div class="list-name">Verticals:</div>
                <div class="description"><%= @product.industries_all %></div>
              </div>
            </div>
          </div>

          <div class = "row">
            <div class="col-md-4 posted-by-column">
              <div class="product-list">
                <div class="list-name">Posted_by:</div>
                <div class="description"><%= link_to user_path(@product.user) do %>
                  <%= @product.user.full_name %>
                <% end %> </div>
              </div>
            </div>
            <div class="col-md-8 oneliner-column">
              <div class="product-list">
                <div id="oneliner">
                  <div class="list-name">Oneliner:</div>
                  <div class="description"><%= @product.oneliner %></div>
                </div>
              </div>
            </div>
          </div>
          <div class = "row">
            <div class="col-md-12 description-column">
              <div class = "product-list">
                  <div class = "list-name">Description:</div>
                  <div class = "big-description"><%= @product.description %></div>
              </div>
            </div>
          </div>
        </div>

        <div class="well product-well">
          <div class="row">
            <div class="col-md-12">
              <div class="product-list">
                <div class= "list-name">Usecases:</div>
                <ul>
                  <% @product.product_usecases.each do |product_usecase| %>
                    <li><%= product_usecase.example %> : <%= product_usecase.detail %></li>
                  <% end %>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div class="well product-well">
          <div class="row">
            <div class="col-md-12">
              <div class="product-list">
                <div class= "list-name">Customers:</div>
                <ul>
                  <% @product.product_customers.each do |product_customer| %>
                    <li><%= product_customer.customer %> : <%= product_customer.usage %></li>
                  <% end %>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div class="well product-well">
          <div class="row">
            <div class="col-md-12">
              <div class="product-list">
                <div class= "list-name">Potential leads:</div>
                <ul>
                  <% @product.product_leads.each do |product_lead| %>
                    <li><%= product_lead.lead %> : <%= product_lead.pitch %></li>
                  <% end %>
                </ul>
              </div>
            </div>
          </div>
        </div>

      <% end %>


      <div class="panel panel-default" id="comment-panel">
        <div class="panel-heading">
          <div class = "row comment-form-row">
            <div class="col-md-12">
              <div class="row">
                <div class="col-md-12">
                  <div class="col-md-12">
                    <%= render partial: 'comments/form', locals: { commentable: @product } %>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <% if @product.comments.size > 3 %>
            <div class="row open-all-comments-row" data-behavior="open-all-comments-row">
              <div class="col-md-12">
                <div class="col-md-12">
                  <a class="open-all-comments" data-commentableid="<%= @product.id %>" data-behavior="open-all-comments">Show all</a>
                </div>
              </div>
            </div>
          <% end %>
        </div>
        <div class="panel-body">
          <div class = "row">
            <div class="col-md-12" data-behavior="comment-insert-<%= @product.id%>">
              <%= render partial: 'comments/comment', collection: @product.comments.ordered.includes(:user, :user_profile), as: :comment, locals: { commentable: @product } %>
            </div>
          </div>
        </div>
      </div>


    </div> 
</div>

  <%= form_for(@product, method: :delete) do |f| %>
    <div class="modal fade" id="deleteproduct_<%= @product.id %>" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content" style="text-align:left">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel">Delete Product</h4>
          </div>
          <div class="modal-body">
            <h4>Are you sure?</h4>
            <p> </p>  
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal" id="deleteproductclose">Close</button>
              <%= f.submit "Delete Product", class: 'btn btn-danger' %>
          </div>
        </div>
      </div>
    </div>
  <% end %>

